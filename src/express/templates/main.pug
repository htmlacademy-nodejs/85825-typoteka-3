extends layout.pug

block content
  -
    const formatDate = (dateString) => {
      const date = new Date(dateString);
      return date.toLocaleString();
    }
    const sliceText = (announce) => {
      if(announce.length > 100) {
        return `${announce.slice(0, 100)}...`;
      }
      return announce;
    }
  main.main-page
    h1.visually-hidden –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ª–∏—á–Ω–æ–≥–æ –±–ª–æ–≥–∞ –¢–∏–ø–æ—Ç–µ–∫–∞
    p
      | –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Å–∞–º—ã–π –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –±–ª–æ–≥ üëè
    section.main-page__theme-list
      h2.visually-hidden –°–ø–∏—Å–æ–∫ —Ç–µ–º
      include partials/themes
    .main-page__section-flex
      section.main-page__hot.hot
        h2.hot__name
          | –°–∞–º–æ–µ –æ–±—Å—É–∂–¥–∞–µ–º–æ–µ
          span.hot__icon.hot__icon--fire
        if popularArticles.length
          ul.hot__list
            each popularArticle in popularArticles
              li.hot__list-item
                a.hot__list-link(href=`/articles/${popularArticle.id}`) #{sliceText(popularArticle.announce)}
                  sup.hot__link-sup #{popularArticle.commentsCount}
        else
          p(class="hot__empty") –ó–¥–µ—Å—å –ø–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç...
      section.main-page__last.last
        h2.last__name
          | –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
          span.last__icon.last__icon--cloud
        if lastComments.length
          ul.last__list
            each comment in lastComments
              li.last__list-item
                img.last__list-image(src=`img/${comment.users.avatar}` width='20' height='20' alt='–ê–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è')
                b.last__list-name #{comment.users.name} #{comment.users.surname}
                a.last__list-link(href=`/articles/${comment.articleId}`)=sliceText(comment.text)
        else
          p(class="hot__empty") –ó–¥–µ—Å—å –ø–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç...
    section.main-page__list.preview
      h2.visually-hidden –°–ø–∏—Å–æ–∫ –ø—Ä–µ–≤—å—é —Å—Ç–∞—Ç–µ–π
      if articles.length
        ul.preview__list
          each article in articles
            li.preview__item(class=article.image ? '' : 'preview__item--noimage')
              ul.preview__breadcrumbs
                each category in article.categories.slice(0, 4)
                  li.preview__breadcrumbs-item
                    a.preview__breadcrumbs-link(href='/articles/category/' + category.id) #{category.name}
              if article.image
                .preview__background
                  img.preview__background-image(src=`img/${article.image}` width='460' height='240' alt=article.title)
              time.preview__time(datetime=article.createdAt) #{formatDate(article.createdAt)}
              h3.preview__name
                a.preview__name-link(href='/articles/' + article.id) #{article.title}
              p.preview__text #{article.announce}
              a.preview__comment(href='/articles/' + article.id)
                | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
                span.preview__cloud
                b.preview__comment-count #{article.comments.length}
      else
        h2 –ó–¥–µ—Å—å –ø–æ–∫–∞ –ø—É—Å—Ç–æ!
    .preview__toggle-wrapper
      +pagination(page, totalPages, 2, `?`)
